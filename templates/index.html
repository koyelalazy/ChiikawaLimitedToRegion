<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chiikawaåœ°å€é™å®šåœ–é‘‘</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700;900&display=swap"
        rel="stylesheet">
    <script async defer src="https://apis.google.com/js/api.js"></script>
    <script async defer src="https://accounts.google.com/gsi/client"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'chii-bg': '#fff5f7',
                        'chii-pink': '#ffb7ce',
                        'chii-dark': '#5d4037',
                    },
                    fontFamily: {
                        sans: ['Zen Maru Gothic', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #fff5f7;
            color: #5d4037;
            background-image: radial-gradient(#ffb7ce 15%, transparent 16%), radial-gradient(#ffb7ce 15%, transparent 16%);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            background-attachment: fixed;
        }

        .region-scroll-container {
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            cursor: grab;
        }

        .region-scroll-container:active {
            cursor: grabbing;
        }

        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .item-card {
            transition: all 0.2s;
        }

        .item-card:active {
            transform: scale(0.95);
        }

        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ffb7ce;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .fade-enter-active,
        .fade-leave-active {
            transition: opacity 0.3s;
        }

        .fade-enter-from,
        .fade-leave-to {
            opacity: 0;
        }

        .filter-btn {
            border: 0;
            outline: none !important;
            margin: 2px 2px 6px 2px;
        }

        .filter-btn-active {
            background-color: #5d4037;
            color: white;
        }

        .filter-btn-inactive {
            background-color: white;
            color: #6b7280;
            border: 1px solid #e5e7eb;
        }

        .star-btn {
            transition: transform 0.2s;
        }

        .star-btn:active {
            transform: scale(0.8);
        }
    </style>
</head>

<body class="h-screen w-screen overflow-hidden flex flex-col">

    {% raw %}

    <div id="app"
        class="h-full flex flex-col w-full mx-auto relative bg-white/90 backdrop-blur-sm shadow-xl md:max-w-5xl md:h-[95vh] md:my-auto md:rounded-3xl border-4 border-white">

        <header class="p-4 bg-white sticky top-0 z-30 shadow-sm flex flex-col gap-3 md:rounded-t-3xl">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center gap-3">
                <div class="flex items-center gap-3">
                    <img src="https://www.popdaily.com.tw/shaper/u/202409/f7984971-9f2d-4ccf-963f-7cc7acfec817.png?resize-w=900&resize-h=900&format=webp"
                        alt="Logo" class="w-12 h-12 object-cover rounded-full border-2 border-chii-pink shadow-sm">
                    <div>
                        <h1 class="text-xl font-black text-chii-dark tracking-wider">Chiikawaåœ°å€é™å®š</h1>
                        <p class="text-xs text-gray-400 font-bold">æ”¶è—åœ–é‘‘</p>
                    </div>
                </div>

                <div class="flex gap-2 self-end sm:self-auto items-center flex-wrap justify-end">
                    <a href="https://www.jp-api.com/contents/NOD62/PGE1/" target="_blank"
                        class="px-3 py-1.5 rounded-full text-xs font-bold text-white bg-pink-400 hover:bg-pink-500 shadow transition-all no-underline">ğŸŒ
                        å®˜ç¶²</a>
                    <div v-if="isLoggedIn"
                        class="flex items-center gap-2 bg-green-50 px-2 py-1 rounded-full text-xs text-green-700 font-bold border border-green-200 h-[30px]">
                        <img v-if="userAvatar" :src="userAvatar" class="w-5 h-5 rounded-full border border-green-300">
                        <span v-else>ğŸ‘¤</span>
                        <span class="max-w-[80px] truncate">{{ userName }}</span>
                    </div>
                    <button v-else @click="handleAuthClick"
                        class="px-3 py-1.5 rounded-full text-xs font-bold text-white bg-blue-500 hover:bg-blue-600 shadow h-[30px]">G
                        ç™»å…¥</button>
                    <button @click="showSettingsModal = true"
                        class="px-3 py-1.5 rounded-full text-xs font-bold text-gray-700 bg-gray-100 hover:bg-gray-200 shadow h-[30px]">âš™ï¸
                        è¨­å®š</button>
                </div>
            </div>

            <div class="flex flex-col gap-3 bg-chii-bg p-3 rounded-xl border border-pink-100">

                <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-2">

                    <div class="flex gap-2 w-full lg:w-auto overflow-x-auto hide-scrollbar">
                        <button v-for="cat in categories" :key="cat.key" @click="selectedCategory = cat.key"
                            class="filter-btn px-4 py-1.5 rounded-lg text-sm font-bold transition-all whitespace-nowrap flex-1 sm:flex-none text-center"
                            :class="selectedCategory === cat.key ? 'filter-btn-active' : 'filter-btn-inactive'">{{
                            cat.label }}</button>
                    </div>

                    <div class="flex gap-2 items-center self-end lg:self-auto flex-wrap justify-end">

                        <div
                            class="flex bg-white rounded-lg p-0.5 border border-gray-200 shadow-sm h-[32px] items-center">
                            <button @click="statusFilter = 'all'"
                                :class="statusFilter === 'all' ? 'bg-chii-dark text-white' : 'text-gray-400'"
                                class="px-3 h-full rounded-md text-xs font-bold transition-all flex items-center">å…¨éƒ¨</button>
                            <button @click="statusFilter = 'owned'"
                                :class="statusFilter === 'owned' ? 'bg-chii-dark text-white' : 'text-gray-400'"
                                class="px-3 h-full rounded-md text-xs font-bold transition-all flex items-center">å·²æ”¶</button>
                            <button @click="statusFilter = 'not_owned'"
                                :class="statusFilter === 'not_owned' ? 'bg-chii-dark text-white' : 'text-gray-400'"
                                class="px-3 h-full rounded-md text-xs font-bold transition-all flex items-center">æœªæ”¶</button>
                        </div>

                        <div
                            class="flex bg-white rounded-lg p-0.5 border border-gray-200 shadow-sm h-[32px] items-center">
                            <button @click="viewMode = 'list'"
                                :class="viewMode === 'list' ? 'bg-chii-dark text-white' : 'text-gray-400'"
                                class="px-3 h-full rounded-md text-xs font-bold transition-all flex items-center">ğŸ“</button>
                            <button @click="initMap"
                                :class="viewMode === 'map' ? 'bg-chii-dark text-white' : 'text-gray-400'"
                                class="px-3 h-full rounded-md text-xs font-bold transition-all flex items-center">ğŸ—ºï¸</button>
                        </div>

                    </div>
                </div>

                <div id="region-scroll-area"
                    class="region-scroll-container flex items-center gap-2 w-full pt-1 border-t border-pink-100/50">
                    <button v-for="region in regions" :key="region" @click="selectedRegion = region"
                        class="filter-btn px-4 py-1.5 rounded-full text-sm flex-shrink-0 transition-all font-bold select-none"
                        :class="selectedRegion === region ? 'bg-chii-pink text-white shadow-md transform scale-105' : 'filter-btn-inactive'">{{
                        region }}</button>
                    <div class="w-1 flex-shrink-0"></div>
                </div>
            </div>
        </header>

        <main class="flex-1 overflow-y-auto p-4 relative bg-transparent">
            <div v-if="!isLoggedIn"
                class="text-center mb-2 bg-yellow-50 p-2 rounded text-xs text-yellow-700 border border-yellow-100">âš ï¸
                æœ¬æ©Ÿæ¨¡å¼ï¼šè³‡æ–™åƒ…å­˜æ–¼æ­¤ç€è¦½å™¨ã€‚</div>

            <div v-show="viewMode === 'list'">
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4 pb-20">

                    <div v-for="(item, index) in filteredItems" :key="item.id || index" @click="toggleOwn(item)"
                        class="item-card bg-white rounded-2xl p-3 shadow-sm border-2 relative overflow-hidden cursor-pointer flex flex-col group"
                        :class="item.owned ? 'border-green-400 bg-green-50' : 'border-white hover:border-pink-200'">

                        <div
                            class="absolute top-1 left-1 z-20 p-1.5 rounded-full bg-white/70 backdrop-blur shadow-sm pointer-events-none">
                            <svg v-if="item.owned" xmlns="http://www.w3.org/2000/svg"
                                class="h-5 w-5 text-yellow-400 drop-shadow-sm" viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                            </svg>
                            <svg v-else xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.784.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                            </svg>
                        </div>

                        <div class="absolute top-2 right-2 z-10"><span v-if="item.owned"
                                class="bg-green-500 text-white text-[10px] px-2 py-1 rounded-full font-bold shadow-sm">GET!</span>
                        </div>

                        <div
                            class="w-full aspect-square bg-gray-50 rounded-xl mb-3 flex items-center justify-center text-5xl shadow-inner relative overflow-hidden">
                            <img v-if="item.image" :src="item.image"
                                class="w-full h-full object-contain transition-transform group-hover:scale-105"
                                loading="lazy">
                            <span v-else class="transform transition-transform group-hover:scale-110 select-none">{{
                                item.emoji }}</span>
                            <button v-if="item.image" @click.stop="openImage(item, index)"
                                class="absolute bottom-1 right-1 bg-white/80 hover:bg-white text-gray-600 hover:text-chii-dark p-1.5 rounded-full shadow-sm backdrop-blur transition-all z-20"
                                title="æŸ¥çœ‹å¤§åœ–"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
                                    viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7" />
                                </svg></button>
                        </div>

                        <div class="flex-1 flex flex-col justify-between">
                            <div>
                                <div class="flex flex-wrap gap-1 mb-1">
                                    <span
                                        class="text-[10px] bg-chii-pink text-white px-1.5 py-0.5 rounded whitespace-nowrap">{{
                                        item.region }}</span>
                                    <span
                                        class="text-[10px] bg-gray-200 text-gray-600 px-1.5 py-0.5 rounded whitespace-nowrap">{{
                                        item.category === 'tag' ? 'éµç‰Œ' : item.category === 'plush' ? 'å¨ƒå¨ƒ' :
                                        item.category === 'socks' ? 'è¥ªå­' : 'å…¶ä»–' }}</span>
                                    <span v-if="item.search_location"
                                        class="text-[10px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded whitespace-nowrap flex items-center">ğŸ“
                                        {{ item.search_location }}</span>
                                </div>
                                <h3 class="text-sm font-bold text-gray-700 leading-tight">{{ item.name }}</h3>
                            </div>
                        </div>
                    </div>
                </div>

                <div v-if="filteredItems.length === 0"
                    class="flex flex-col items-center justify-center py-20 text-gray-400 gap-4">
                    <div v-if="items.length === 0" class="text-center">
                        <div class="text-4xl mb-2">ğŸ“¥</div>
                        <p>è³‡æ–™åº«ç›®å‰æ˜¯ç©ºçš„</p>
                    </div>
                    <div v-else class="text-center">
                        <div class="text-4xl">ğŸŒ«ï¸</div>
                        <p>é€™å€‹åˆ†é¡ä¸‹é‚„æ²’æœ‰å•†å“è³‡æ–™å–”</p>
                    </div>
                </div>
            </div>
            <div v-show="viewMode === 'map'" class="absolute inset-0 z-0 bg-gray-100 md:rounded-b-2xl overflow-hidden">
                <div id="map" class="h-full w-full"></div>
            </div>
        </main>

        <footer
            class="bg-white/95 backdrop-blur border-t border-pink-100 p-4 pb-6 shadow-[0_-5px_20px_rgba(0,0,0,0.05)] z-20 md:rounded-b-3xl">
            <div class="flex justify-between items-center max-w-2xl mx-auto md:max-w-none">
                <div class="flex flex-col">
                    <span class="text-xs text-gray-400 font-bold">COLLECTION STATUS</span>
                    <div class="flex items-baseline gap-2">
                        <span class="text-2xl font-black text-chii-dark">{{ ownedCount }}</span>
                        <span class="text-sm text-gray-400 font-bold">/ {{ filteredItems.length }}</span>
                    </div>
                </div>
                <div class="flex-1 mx-4 max-w-xs">
                    <div class="h-3 w-full bg-gray-100 rounded-full overflow-hidden shadow-inner">
                        <div class="h-full bg-gradient-to-r from-green-400 to-green-500 transition-all duration-700 ease-out"
                            :style="{width: progressPercentage + '%'}"></div>
                    </div>
                </div>
                <div class="text-green-500 font-black text-lg">{{ Math.round(progressPercentage) }}%</div>
            </div>
        </footer>

        <transition name="fade">
            <div v-if="showModal" class="fixed inset-0 z-50 flex items-center justify-center p-4" @click="closeModal">
                <div class="absolute inset-0 bg-black/90 backdrop-blur-sm"></div>
                <div
                    class="relative z-10 w-full max-w-4xl h-full flex flex-col items-center justify-center pointer-events-none">
                    <div class="bg-white rounded-2xl p-2 md:p-4 shadow-2xl relative flex flex-col max-h-[85vh] w-auto pointer-events-auto"
                        @click.stop>
                        <button @click="closeModal"
                            class="absolute -top-4 -right-4 bg-chii-dark text-white rounded-full p-2 shadow-lg hover:bg-gray-800 transition-all z-20 border-2 border-white"><svg
                                xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20"
                                fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                    clip-rule="evenodd" />
                            </svg></button>

                        <button @click.stop="toggleModalItem"
                            class="star-btn absolute -top-4 -left-4 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-all z-20 border-2 border-white"
                            :title="modalItem.owned ? 'å–æ¶ˆæ”¶è—' : 'åŠ å…¥æ”¶è—'">
                            <svg v-if="modalItem.owned" xmlns="http://www.w3.org/2000/svg"
                                class="h-8 w-8 text-yellow-400 drop-shadow-sm" viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                            </svg>
                            <svg v-else xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-300" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.784.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                            </svg>
                        </button>

                        <div
                            class="flex-1 overflow-auto flex items-center justify-center bg-gray-50 rounded-xl min-w-[300px] min-h-[300px]">
                            <img :src="modalImage" class="max-w-full max-h-[60vh] object-contain" alt="Large view">
                        </div>
                        <div class="mt-4 text-center">
                            <h3 class="text-lg font-bold text-chii-dark">{{ modalTitle }}</h3>
                            <p class="text-sm text-gray-500">{{ modalSubtitle }}</p>
                        </div>
                    </div>
                    <button v-if="currentModalIndex > 0" @click.stop="prevImage"
                        class="absolute left-2 md:left-8 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/40 text-white rounded-full p-3 backdrop-blur transition-all pointer-events-auto"><svg
                            xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg></button>
                    <button v-if="currentModalIndex < filteredItems.length - 1" @click.stop="nextImage"
                        class="absolute right-2 md:right-8 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/40 text-white rounded-full p-3 backdrop-blur transition-all pointer-events-auto"><svg
                            xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg></button>
                </div>
            </div>
        </transition>

        <div v-if="showSettingsModal" class="fixed inset-0 z-[60] flex items-center justify-center p-4">
            <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" @click="showSettingsModal = false"></div>
            <div class="bg-white rounded-2xl p-6 shadow-2xl z-10 w-full max-w-sm relative">
                <button @click="showSettingsModal = false"
                    class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><svg
                        xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg></button>
                <h2 class="text-xl font-bold text-chii-dark mb-6 text-center border-b pb-2">è¨­å®šèˆ‡åŠŸèƒ½</h2>

                <div class="mb-6">
                    <h3 class="text-sm font-bold text-gray-500 mb-2 flex items-center gap-1">â˜ï¸ é›²ç«¯åŒæ­¥ <span
                            class="text-[10px] bg-gray-100 text-gray-400 px-1 rounded">Google Drive</span></h3>
                    <div v-if="isLoggedIn">
                        <button @click="openPicker"
                            class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg text-sm mb-2 flex items-center justify-center gap-2">
                            <span>ğŸ“‚</span> <span class="truncate max-w-[200px]">{{ folderName || 'é¸æ“‡è³‡æ–™å¤¾' }}</span>
                        </button>
                        <button @click="logout"
                            class="w-full border border-red-200 text-red-500 hover:bg-red-50 py-2 rounded-lg text-sm">ç™»å‡º
                            Google</button>
                    </div>
                    <div v-else>
                        <button @click="handleAuthClick"
                            class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg text-sm font-bold shadow-md flex items-center justify-center gap-2">
                            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z" />
                            </svg>
                            ç™»å…¥ Google Drive
                        </button>
                        <p class="text-xs text-gray-400 mt-2 text-center">ç™»å…¥å¾Œå¯è·¨è£ç½®åŒæ­¥æ”¶è—ï¼Œæœªç™»å…¥åƒ…å­˜æ–¼æœ¬æ©Ÿã€‚</p>
                    </div>
                </div>

                <div class="mb-6">
                    <h3 class="text-sm font-bold text-gray-500 mb-2">ğŸ‘¤ å€‹äººè³‡æ–™ç®¡ç†</h3>
                    <div class="flex flex-col gap-2">
                        <div class="grid grid-cols-2 gap-2">
                            <button @click="exportUserData"
                                class="bg-yellow-100 hover:bg-yellow-200 text-yellow-800 py-2 rounded-lg text-sm font-bold">ğŸ“¤
                                å‚™ä»½æ”¶è—</button>
                            <button @click="triggerImportUser"
                                class="bg-green-100 hover:bg-green-200 text-green-800 py-2 rounded-lg text-sm font-bold">ğŸ“¥
                                é‚„åŸæ”¶è—</button>
                            <input type="file" id="importUserFile" @change="importUserData" class="hidden"
                                accept=".json">
                        </div>
                        <button @click="resetSelections"
                            class="w-full border border-orange-300 text-orange-600 hover:bg-orange-50 py-2 rounded-lg text-sm font-bold">ğŸš«
                            æ¸…é™¤æ‰€æœ‰å‹¾é¸</button>
                    </div>
                </div>

                <div v-if="isAdmin" class="border-t pt-4 bg-gray-50 -mx-6 px-6 pb-6 -mb-6 rounded-b-2xl">
                    <h3 class="text-sm font-bold text-purple-600 mb-2 flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        ç®¡ç†å“¡å°ˆå€
                    </h3>

                    <div class="grid grid-cols-2 gap-2 mb-2">
                        <button @click="autoUpdate" :disabled="isUpdating"
                            class="bg-chii-dark hover:bg-gray-700 text-white py-2 rounded-lg text-sm flex items-center justify-center gap-1"><span
                                v-if="!isUpdating">ğŸ”„ æ›´æ–°å•†å“</span><span v-else class="loader scale-50"></span></button>
                        <button @click="fixRegions" :disabled="isUpdating"
                            class="bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg text-sm">ğŸŒ ä¿®æ­£åœ°å€</button>
                    </div>

                    <div class="grid grid-cols-2 gap-2 mb-2">
                        <button @click="exportPublicData"
                            class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg text-sm">ğŸ“¤ åŒ¯å‡º
                            DB</button>
                        <button @click="triggerImportPublic"
                            class="bg-gray-600 hover:bg-gray-700 text-white py-2 rounded-lg text-sm">ğŸ“¥ åŒ¯å…¥ DB</button>
                    </div>
                    <input type="file" id="importPublicFile" @change="importPublicData" class="hidden" accept=".json">

                    <button @click="deletePublicData"
                        class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg text-sm font-bold mt-2">âš ï¸
                        æ¸…é™¤æ‰€æœ‰å•†å“è³‡è¨Š</button>
                </div>
            </div>
        </div>

    </div>

    {% endraw %}

    <script src="/static/js/config.js"></script>
    <script type="module" src="/static/js/storage.js"></script>
    <script type="module" src="/static/js/ui.js"></script>
    <script type="module" src="/static/js/main.js"></script>
</body>

</html>